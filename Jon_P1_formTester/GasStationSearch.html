<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
      <title>Jon's TEST</title>
   </head>
   <body>

   <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div id="results">

                </div>
            </div>
         </div>
   </div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
      <script>
         var locations = [];
         var distances = [];

         var myurl = "https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/search?term=gas&location=27510";
         getURL();
         function getURL() {
            $.ajax({
            url: myurl,
            method: "GET",
            dataType: 'json',
            headers: {
             'Authorization':'Bearer T2wxpy51o7xLn4IRb0aA-wYFxHJm2fVI61S3T93kHvUh3OgaUJi2vNTjwKbJtvRvHyyhFVOE2JlajaiHeRXQbmmI4bGvwfUbknG7vIXJ756j8FNwzw9m47blHc6YXnYx',
            }
         }).then(getGas);

         function getGas(data) {
            console.log(data);
            console.log(locations)
            for (var i = 0; i < 10; i++) {
               locations[i] = data.businesses[i].location.address1;
               distances[i] = data.businesses[i].distance;
            }
            console.log(locations);
            console.log(distances);
         }
      }

      </script>
   </body>
</html>


<!-- 
// set test variables
var lat = "";
var lon = "";
var max = 10;
var queryURL = "";
var key = "20838232-00c1-498d-8c22-91d34f923df8";
var token = "1beabf666d8a29";
var address = "7711 fiesta way raleigh";

var geocode_Base = `https://us1.locationiq.com/v1/search.php?key=${token}&q=${address}&format=json`;

getLatLon();

// convert address to lat lon
function getLatLon() {
    $.ajax({
        url: geocode_Base,
        method: "GET"
    }).then(updateLatLon);
}
// set lat and lon variables from api
function updateLatLon(latlon) {
    lat = latlon[0].lat;
    lon = latlon[0].lon;
    getURL();
}
// get electric data from api
function getURL(){
    baseURL = "https://api.openchargemap.io/v3/poi/?";
    queryURL = `${baseURL}&key=${key}&output=json&latitude=${lat}&longitude=${lon}&maxresults=${max}&distanceunit=Miles&distance=25`
    $.ajax({        
        url: queryURL,
        method: "GET"
    }).then(updatePage);
}
// return locations and types of chargers
function updatePage(data) {
    for (i=0; i < data.length; i++) {
        var location = `Address: ${data[i].AddressInfo.Title} ${data[i].AddressInfo.Town}, ${data[i].AddressInfo.Postcode}`;
        var chargerType = `Charger Type: ${data[i].Connections[0].ConnectionType.FormalName}`;
        console.log(location);
        console.log(chargerType);
        console.log("");
    }
} -->


